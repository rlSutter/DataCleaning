# Data Cleaning Service - ASP.NET VB Web Services

A comprehensive fuzzy-matching and weighted data-cleaning library implemented as ASP.NET VB web services that utilizes match keys generated by MelissaData for contact, organization, and address standardization and deduplication.

## Overview

This service provides a robust data cleaning and standardization platform that integrates with MelissaData's Data Quality Tools (DQT) and MatchUP services to perform:

- **Contact Standardization**: Name parsing, gender detection, and fuzzy matching
- **Organization Standardization**: Company name cleaning and deduplication
- **Address Standardization**: Address validation, geocoding, and CASS certification
- **Fuzzy Matching**: Advanced matching algorithms with configurable weights
- **Geocoding**: Integration with multiple geocoding services (Bing Maps, Geocodio)

## Architecture

### Technology Stack
- **Framework**: ASP.NET 4.0 Web Services (VB.NET)
- **Database**: SQL Server with Siebel CRM schema
- **Data Quality**: MelissaData DQT and MatchUP
- **Logging**: Log4Net with multiple appenders
- **Geocoding**: Bing Maps API, Geocodio API
- **Authentication**: Certegrity Cloud Services

### Core Components

#### Web Service Methods
1. **StandardizeContact** - Standardizes contact records and generates match codes
2. **StandardizeOrganization** - Standardizes organization/account records
3. **StandardizeAddress** - Standardizes address records with geocoding
4. **StandardizeAddress_SAS** - SAS-specific address standardization
5. **CleanContact** - Comprehensive contact cleaning and deduplication
6. **CleanOrganization** - Organization cleaning and matching
7. **CleanAddress** - Address cleaning and validation
8. **CleanRecord** - Generic record cleaning
9. **GeoencodeAddress** - Geocoding service for addresses

#### Database Schema
The service uses a Siebel CRM-compatible database schema with the following key tables:

- **S_CONTACT**: Main contact records
- **S_CONTACT_X**: Contact extension records
- **S_POSTN_CON**: Contact position records
- **S_ORG_EXT**: Organization/account records
- **S_ACCNT_POSTN**: Account position records
- **S_ADDR_PER**: Personal address records
- **S_ADDR_PER_X**: Personal address extension records
- **S_ADDR_ORG**: Organization address records
- **S_ADDR_ORG_X**: Organization address extension records
- **S_LST_OF_VAL**: Lookup values (country codes, etc.)

## Installation and Setup

### Prerequisites
- Windows Server with IIS
- .NET Framework 4.0 or higher
- SQL Server 2008 or higher
- MelissaData DQT and MatchUP licenses
- Internet access for geocoding services

### Database Setup
1. Run the provided `database_schema.sql` script to create the required database schema
2. Configure connection strings in `web.config`
3. Ensure proper permissions for the application service account

### Configuration

#### Web.config Settings
```xml
<appSettings>
  <!-- MelissaData Configuration -->
  <add key="MD_Key" value="YOUR_MELISSADATA_LICENSE_KEY"/>
  <add key="MD_MU_Key" value="YOUR_MELISSADATA_MATCHUP_KEY"/>
  <add key="MD_DataPath" value="C:\Program Files\Melissa DATA\DQT\Data"/>
  <add key="MD_MU_DataPath" value="C:\ProgramData\Melissa DATA\MatchUP"/>
  
  <!-- Geocoding Services -->
  <add key="bing_key" value="YOUR_BING_MAPS_API_KEY"/>
  <add key="geocodio_key" value="YOUR_GEOCODIO_API_KEY"/>
  <add key="GeocodeUrl" value="https://api.geocod.io/v1/geocode?"/>
  
  <!-- Certegrity Cloud Services -->
  <add key="com.certegrity.cloudsvc.service" value="https://cloudsvc.certegrity.com/basic/service.asmx"/>
  
  <!-- Debug Settings -->
  <add key="CleanOrganization_debug" value="Y"/>
  <add key="CleanContact_debug" value="Y"/>
  <add key="CleanAddress_debug" value="Y"/>
</appSettings>
```

#### Connection Strings
```xml
<connectionStrings>
  <add name="hcidb" connectionString="server=YOUR_SERVER;uid=YOUR_USER;pwd=YOUR_PASSWORD;database=YOUR_DATABASE" providerName="System.Data.SqlClient"/>
  <add name="hcidb_ro" connectionString="server=YOUR_SERVER;uid=YOUR_USER;pwd=YOUR_PASSWORD;ApplicationIntent=ReadOnly;database=YOUR_DATABASE" providerName="System.Data.SqlClient"/>
</connectionStrings>
```

### MelissaData Setup
1. Install MelissaData DQT and MatchUP software
2. Configure data paths in web.config
3. Ensure license keys are valid and up-to-date
4. Verify data files are accessible

## API Documentation

### StandardizeContact

Standardizes contact records and optionally creates/updates database records.

**Input XML Format:**
```xml
<Contacts>
  <Contact>
    <Debug>Y</Debug>
    <Database>C</Database>
    <ConId></ConId>
    <FirstName>John</FirstName>
    <MidName>Michael</MidName>
    <LastName>Smith</LastName>
    <Gender>M</Gender>
    <FullName>John Michael Smith</FullName>
  </Contact>
</Contacts>
```

**Parameters:**
- `Debug`: "Y" for debug mode, "N" for normal mode, "T" for test mode
- `Database`: "C" to create record, "U" to update record, blank for no database action
- `ConId`: Existing contact ID for updates
- `FirstName`, `MidName`, `LastName`: Contact name components
- `Gender`: "M" or "F"
- `FullName`: Complete name string

**Output:** XML document with standardized contact data and match codes

### StandardizeOrganization

Standardizes organization/account records.

**Input XML Format:**
```xml
<Organizations>
  <Organization>
    <Debug>Y</Debug>
    <Database>C</Database>
    <OrgId></OrgId>
    <Name>Acme Corporation</Name>
    <Location>New York, NY</Location>
  </Organization>
</Organizations>
```

### StandardizeAddress

Standardizes address records with geocoding capabilities.

**Input XML Format:**
```xml
<Addresses>
  <Address>
    <Debug>Y</Debug>
    <Database>C</Database>
    <AddrId></AddrId>
    <AddrType>P</AddrType>
    <Addr>123 Main Street</Addr>
    <City>New York</City>
    <State>NY</State>
    <ZipCode>10001</ZipCode>
    <Country>US</Country>
    <GeocodeAddr>Y</GeocodeAddr>
  </Address>
</Addresses>
```

**Parameters:**
- `AddrType`: "P" for personal, "O" for organization
- `GeocodeAddr`: "Y" to perform geocoding, "N" to skip

### CleanContact

Comprehensive contact cleaning with fuzzy matching and deduplication.

**Features:**
- Name parsing and standardization
- Gender detection
- Fuzzy matching against existing records
- Match score calculation
- Duplicate detection and resolution

### CleanOrganization

Organization cleaning with advanced matching algorithms.

**Features:**
- Company name standardization
- Industry classification
- Fuzzy matching with configurable weights
- Duplicate organization detection

### CleanAddress

Address cleaning and validation.

**Features:**
- Address standardization
- CASS certification
- Geocoding integration
- Delivery point validation
- Address quality scoring

## Data Quality Features

### MelissaData Integration
- **Name Object**: Contact name parsing and standardization
- **Address Object**: Address validation and standardization
- **MatchUP**: Advanced fuzzy matching and deduplication
- **Geocoding**: Coordinate assignment and validation

### Matching Algorithms
- **Fuzzy String Matching**: Levenshtein distance and phonetic matching
- **Weighted Scoring**: Configurable weights for different match criteria
- **Threshold-based Matching**: Configurable match confidence levels
- **Multi-field Matching**: Cross-field validation and matching

### Geocoding Services
- **Bing Maps API**: Primary geocoding service
- **Geocodio API**: Secondary geocoding service with enhanced accuracy
- **Coordinate Validation**: Latitude/longitude verification
- **Address Quality Scoring**: Delivery confidence and accuracy metrics

## Logging and Monitoring

### Log4Net Configuration
The service uses Log4Net for comprehensive logging with multiple appenders:

- **RemoteSyslogAppender**: Centralized logging to syslog server
- **File Appenders**: Service-specific log files with rotation
- **Debug Logging**: Detailed operation logging for troubleshooting

### Log Categories
- **SADebugLog**: Standardize Address operations
- **SCDebugLog**: Standardize Contact operations
- **SODebugLog**: Standardize Organization operations
- **CADebugLog**: Clean Address operations
- **CCDebugLog**: Clean Contact operations
- **CODebugLog**: Clean Organization operations
- **CRDebugLog**: Clean Record operations
- **MRDebugLog**: Match Record operations
- **GADebugLog**: Geocode Address operations

## Performance Considerations

### Database Optimization
- Indexed columns for fast lookups
- Connection pooling for database connections
- Read-only connections for reporting queries
- Optimized SQL queries with proper joins

### Caching
- MelissaData object caching for improved performance
- Database connection pooling
- Result caching for frequently accessed data

### Scalability
- Stateless web service design
- Thread-safe operations
- Configurable connection pool sizes
- Load balancing support

## Security

### Authentication
- Certegrity Cloud Services integration
- API key-based authentication for external services
- Database connection security

### Data Protection
- SQL injection prevention through parameterized queries
- Input validation and sanitization
- Secure configuration management

## Troubleshooting

### Common Issues

1. **MelissaData License Errors**
   - Verify license keys are valid and not expired
   - Check data file paths and permissions
   - Ensure MelissaData software is properly installed

2. **Database Connection Issues**
   - Verify connection strings in web.config
   - Check database server accessibility
   - Ensure proper permissions for service account

3. **Geocoding Failures**
   - Verify API keys for geocoding services
   - Check internet connectivity
   - Review rate limiting and quota usage

4. **Performance Issues**
   - Monitor database connection pool usage
   - Check MelissaData data file access performance
   - Review log files for bottlenecks

### Debug Mode
Enable debug mode by setting the `Debug` parameter to "Y" in service calls. This provides detailed logging of all operations and helps identify issues.

## API Examples

### C# Client Example
```csharp
using System;
using System.Xml;

// Create service proxy
var service = new Service();

// Standardize contact
string xmlInput = @"<Contacts>
  <Contact>
    <Debug>Y</Debug>
    <Database>C</Database>
    <FirstName>John</FirstName>
    <LastName>Smith</LastName>
    <Gender>M</Gender>
    <FullName>John Smith</FullName>
  </Contact>
</Contacts>";

XmlDocument result = service.StandardizeContact(xmlInput);
Console.WriteLine(result.OuterXml);
```

### VB.NET Client Example
```vb
Imports System.Xml

' Create service proxy
Dim service As New Service()

' Standardize organization
Dim xmlInput As String = "<Organizations>" & _
  "<Organization>" & _
    "<Debug>Y</Debug>" & _
    "<Database>C</Database>" & _
    "<Name>Acme Corporation</Name>" & _
    "<Location>New York, NY</Location>" & _
  "</Organization>" & _
"</Organizations>"

Dim result As XmlDocument = service.StandardizeOrganization(xmlInput)
Console.WriteLine(result.OuterXml)
```

## Support and Maintenance

### Regular Maintenance
- Monitor MelissaData license expiration dates
- Update geocoding service API keys as needed
- Review and rotate log files
- Monitor database performance and storage

### Version Updates
- MelissaData software updates
- .NET Framework updates
- SQL Server updates
- Third-party service API changes

## License and Dependencies

### Third-Party Components
- **MelissaData DQT**: Commercial license required
- **MelissaData MatchUP**: Commercial license required
- **Log4Net**: Apache License 2.0
- **Bing Maps API**: Microsoft commercial license
- **Geocodio API**: Commercial license required

### System Requirements
- Windows Server 2008 R2 or higher
- IIS 7.0 or higher
- .NET Framework 4.0 or higher
- SQL Server 2008 or higher
- Minimum 4GB RAM
- 10GB free disk space for MelissaData files

## Contact Information

For technical support and questions regarding this data cleaning service, please contact the development team or refer to the internal documentation.

---

*This documentation covers the core functionality of the Data Cleaning Service. For specific implementation details and advanced configuration options, refer to the source code and configuration files.*
